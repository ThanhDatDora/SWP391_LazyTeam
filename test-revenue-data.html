<!DOCTYPE html>
<html>
<head>
    <title>Test Revenue Data</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .result { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; }
        pre { background: #f0f0f0; padding: 15px; border-radius: 4px; overflow-x: auto; }
        button { padding: 10px 20px; background: #0066cc; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîç Test Revenue Data</h1>
    <button onclick="testRevenue()">Test Revenue API</button>
    <div id="result" class="result"></div>

    <script>
        const API_BASE = 'http://localhost:3001';
        
        function getToken() {
            const authStr = localStorage.getItem('auth');
            if (authStr) {
                try {
                    return JSON.parse(authStr).token;
                } catch (e) {
                    return null;
                }
            }
            return null;
        }

        async function testRevenue() {
            const resultEl = document.getElementById('result');
            resultEl.innerHTML = '<p>Testing...</p>';
            
            try {
                const token = getToken();
                if (!token) {
                    resultEl.innerHTML = '<p style="color: red;">No token found!</p>';
                    return;
                }

                const response = await fetch(`${API_BASE}/api/instructor/revenue/summary`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Cache-Control': 'no-cache'
                    }
                });

                const data = await response.json();
                
                const revenue = data.data?.summary?.instructorShare || 0;
                const total = data.data?.summary?.totalRevenue || 0;
                
                resultEl.innerHTML = `
<h2>‚úÖ Revenue API Response</h2>
<p><strong>Status:</strong> ${response.status}</p>

<h3>Summary:</h3>
<ul>
    <li><strong>Total Revenue:</strong> $${total.toFixed(2)}</li>
    <li><strong>Instructor Share (80%):</strong> $${revenue.toFixed(2)}</li>
</ul>

<h3>Full Response:</h3>
<pre>${JSON.stringify(data, null, 2)}</pre>

<h3>Explanation:</h3>
<p>Gi√° trong database: <strong>USD</strong> (v√≠ d·ª•: 10.00)</p>
<p>Hi·ªÉn th·ªã tr√™n UI: <strong>VND</strong> (10.00 √ó 1000 = 10,000ƒë)</p>
<p>Revenue: <strong>USD</strong> (kh√¥ng nh√¢n 1000)</p>
                `;
            } catch (error) {
                resultEl.innerHTML = `<p style="color: red;">‚ùå Error: ${error.message}</p>`;
            }
        }

        window.onload = () => {
            if (getToken()) {
                testRevenue();
            } else {
                document.getElementById('result').innerHTML = '<p style="color: red;">Please login first!</p>';
            }
        };
    </script>
</body>
</html>
